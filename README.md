Этот проект представляет собой систему управления заказами на билеты, написанную на PHP (Laravel). Система позволяет создавать заказы на билеты на мероприятия, отправлять их на бронирование через внешний API и получать подтверждение бронирования.
## Требования

- PHP >= 8.0
- Composer
- Laravel >= 9.x
- MySQL

## Установка

1. **Склонируйте репозиторий:**
   ```bash
   git clone https://github.com/ваш-репозиторий.git
   ```
2. **Установите зависимости:**
    ```bash
    composer install
    ```
3.  **Настройте файл .env: Скопируйте .env.example в .env и настройте параметры для доступа к базе данных и внешнему API бронирования.**
4.  Запустите миграции:
    ```bash
    php artisan migrate
    ```

5. Запустите сервер:
    ```bash
   php artisan serve
    ```

    ### Контроллеры:

- **OrderController**: Отвечает за создание заказа, его бронирование через API и подтверждение.
    

### Модели:

- **Order**: Модель заказа.
    
- **Ticket**: Модель билета.
    
- **TicketType**: Модель типа билета (например, взрослый, детский).
    

### Миграции:

- **orders**: Таблица для хранения заказов.
    
- **tickets**: Таблица для хранения билетов, связанных с заказами.
    
- **ticket_types**: Таблица для хранения типов билетов.
    

## API Endpoints

### POST `/api/storeOrder`

Эндпоинт для создания заказа и его бронирования через внешний API.

#### Параметры запроса:

- `event_id` (integer) - ID мероприятия.
    
- `event_date` (datetime) - Дата и время мероприятия.
    
- `ticket_adult_price` (float) - Стоимость взрослого билета.
    
- `ticket_adult_quantity` (integer) - Количество взрослых билетов.
    
- `ticket_kid_price` (float) - Стоимость детского билета (необязательно).
    
- `ticket_kid_quantity` (integer) - Количество детских билетов (необязательно).
    
- `user_id` (integer) - ID пользователя, создавшего заказ.
    

#### Ответы:

- **200 OK** - Заказ успешно одобрен.
    
- **400 Bad Request** - Ошибка бронирования или подтверждения.
    
- **500 Internal Server Error** - Ошибка сервера при бронировании.
    

## Модели

### Order

Модель `Order` представляет заказ на мероприятие. Связи:

- `tickets()` - Связь с моделью `Ticket` (hasMany).
    

### Ticket

Модель `Ticket` представляет билет в заказе. Связи:

- `order()` - Связь с моделью `Order` (belongsTo).
    
- `ticketType()` - Связь с моделью `TicketType` (belongsTo).
    

### TicketType

Модель `TicketType` представляет типы билетов (например, взрослый или детский). Связи:

- `tickets()` - Связь с моделью `Ticket` (hasMany).
    

## Миграции

### orders

Таблица для хранения заказов.

- `event_id` - ID мероприятия.
    
- `event_date` - Дата и время мероприятия.
    
- `ticket_adult_price` - Стоимость взрослого билета.
    
- `ticket_adult_quantity` - Количество взрослых билетов.
    
- `ticket_kid_price` - Стоимость детского билета.
    
- `ticket_kid_quantity` - Количество детских билетов.
    
- `barcode` - Уникальный штрихкод заказа.
    
- `user_id` - ID пользователя.
    
- `equal_price` - Общая стоимость заказа.
    

### ticket_types

Таблица для хранения типов билетов.

- `title` - Название типа (например, взрослый, детский).
    

### tickets

Таблица для хранения билетов в заказе.

- `order_id` - ID заказа.
    
- `ticket_type_id` - ID типа билета.
    
- `price` - Стоимость билета.
    
- `barcode` - Уникальный штрихкод билета.
